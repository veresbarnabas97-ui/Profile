<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SkyAI Dashboard | Profil v4.0</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.ethers.io/lib/ethers-5.2.umd.min.js"></script>

    <style>
        :root {
            --primary-text: #f0f0f0;
            --accent-color: #00d4ff;      /* SkyAI Blue */
            --vip-gold: #ffd700;          /* VIP Gold */
            --bg-color: #050505;
            --card-bg: rgba(20, 20, 20, 0.7);
            --sidebar-bg: rgba(10, 10, 10, 0.95);
            --font-main: 'Roboto', sans-serif;
        }

        body {
            font-family: var(--font-main);
            margin: 0; padding: 0;
            background-color: var(--bg-color);
            color: var(--primary-text);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* M√°trix/Cyber h√°tt√©r */
        body::after {
            content: ""; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-image: 
                linear-gradient(rgba(0, 212, 255, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 212, 255, 0.05) 1px, transparent 1px);
            background-size: 40px 40px;
            z-index: -2; pointer-events: none;
        }

        .dashboard-container { display: flex; min-height: 100vh; }

        /* --- SIDEBAR --- */
        .sidebar {
            width: 260px;
            background: var(--sidebar-bg);
            border-right: 1px solid #333;
            display: flex; flex-direction: column;
            padding: 20px;
            transition: all 0.3s;
        }
        .logo {
            font-size: 1.8rem; color: var(--accent-color); font-weight: bold;
            text-align: center; margin-bottom: 40px; text-transform: uppercase;
            letter-spacing: 2px; text-shadow: 0 0 10px rgba(0,212,255,0.5);
        }
        .menu-item {
            padding: 15px; color: #888; cursor: pointer; border-radius: 8px;
            margin-bottom: 8px; transition: 0.3s; display: flex; align-items: center; gap: 10px;
        }
        .menu-item:hover, .menu-item.active {
            background: rgba(0, 212, 255, 0.1); color: #fff;
            border-left: 4px solid var(--accent-color);
        }
        .btn-logout {
            margin-top: auto; background: #222; color: #fff; border: 1px solid #444;
            padding: 12px; cursor: pointer; border-radius: 8px; transition: 0.3s;
        }
        .btn-logout:hover { background: #dd2e44; border-color: #dd2e44; }

        /* --- MAIN CONTENT --- */
        .main-content { flex: 1; padding: 40px; overflow-y: auto; }

        header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 40px; border-bottom: 1px solid #333; padding-bottom: 20px;
        }
        .user-badge {
            background: #1a1a1a; padding: 8px 15px; border-radius: 20px;
            border: 1px solid #333; font-family: monospace; color: var(--accent-color);
        }

        /* K√°rty√°k */
        .stats-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px; margin-bottom: 40px;
        }
        .card {
            background: var(--card-bg); border: 1px solid #333; border-radius: 16px;
            padding: 25px; backdrop-filter: blur(10px); position: relative; overflow: hidden;
            box-shadow: 0 4px 20px rgba(0,0,0,0.4); transition: transform 0.3s;
        }
        .card:hover { transform: translateY(-5px); border-color: var(--accent-color); }
        
        .card h3 { margin: 0 0 15px 0; font-size: 0.9rem; color: #888; text-transform: uppercase; letter-spacing: 1px; }
        .card .value { font-size: 2rem; font-weight: bold; margin-bottom: 5px; }
        .card .sub { font-size: 0.85rem; color: #666; }

        /* VIP Card Design */
        .card.vip-card { border: 1px solid var(--vip-gold); box-shadow: 0 0 15px rgba(255, 215, 0, 0.1); }
        .vip-badge {
            display: inline-block; background: var(--vip-gold); color: #000;
            padding: 2px 8px; border-radius: 4px; font-weight: bold; font-size: 0.8rem;
            vertical-align: middle; margin-left: 10px;
        }

        /* JELZ√âSEK SZEKCI√ì */
        .signal-box {
            background: #111; border: 1px dashed #444; border-radius: 12px; padding: 20px;
            margin-top: 20px; min-height: 150px; display: flex; align-items: center; justify-content: center;
            flex-direction: column; text-align: center;
        }
        .blur-text { filter: blur(5px); user-select: none; opacity: 0.5; }

        /* --- MOBIL OPTIMALIZ√ÅL√ÅS (CSS ARMOR) --- */
        @media (max-width: 768px) {
            .dashboard-container { flex-direction: column !important; }
            
            /* Men√ºsor fentre ragasztva */
            .sidebar { 
                width: 100% !important; 
                height: auto; 
                flex-direction: row; 
                overflow-x: auto; /* G√∂rgethet≈ë oldalra */
                white-space: nowrap;
                padding: 10px; 
                box-sizing: border-box;
                position: sticky;
                top: 0;
                z-index: 100;
                background: #000;
                border-bottom: 1px solid #333;
            }
            
            .logo { display: none; }
            .btn-logout { padding: 5px 10px; font-size: 0.8rem; }
            
            .main-content { padding: 15px; }
            
            /* K√°rty√°k egym√°s al√° k√©nyszer√≠t√©se */
            .stats-grid { display: flex; flex-direction: column; gap: 15px; }
            
            header { flex-direction: column; align-items: flex-start; gap: 10px; }
            .user-badge { width: 100%; text-align: center; box-sizing: border-box; }
        }
    </style>
</head>
<body>

    <div class="dashboard-container">
        <div class="sidebar">
            <div class="logo">SkyAI v4.0</div>
            <div class="menu-item active" onclick="showSection('dashboard')">üìä Vez√©rl≈ëpult</div>
            <div class="menu-item" onclick="showSection('signals')">ü§ñ AI Jelz√©sek</div>
            <div class="menu-item" onclick="window.open('https://t.me/SkyAI00bot1', '_blank')">üí¨ Telegram Csoport</div>
            
            <button class="btn-logout" onclick="logout()">Kil√©p√©s</button>
        </div>

        <div class="main-content">
            <header>
                <div>
                    <h2 style="margin:0;">√údv√∂z√∂llek, Pil√≥ta!</h2>
                    <p style="margin:0; color:#666; font-size:0.9rem;">SkyAI Decentraliz√°lt Hub</p>
                </div>
                <div id="userAddress" class="user-badge">Not Connected</div>
            </header>

            <div class="stats-grid">
                <div class="card" id="statusCard">
                    <h3>Tags√°gi Szint</h3>
                    <div class="value" id="membershipLevel">Bet√∂lt√©s...</div>
                    <div class="sub" id="vipProgress">Min. 5,000 SKY a VIP-hez</div>
                </div>

                <div class="card">
                    <h3>SKY Token Egyenleg</h3>
                    <div class="value" id="skyBalance">0.00</div>
                    <div class="sub">Contract: 0xcBba...fa83</div>
                </div>

                <div class="card">
                    <h3>Wallet Egyenleg</h3>
                    <div class="value" id="nativeBalance">0.00</div>
                    <div class="sub" id="nativeSymbol">ETH/BNB</div>
                </div>
            </div>

            <div class="card" style="border-color: var(--accent-color);">
                <h3>ü§ñ Legut√≥bbi AI Jelz√©sek (Brain v3.0)</h3>
                
                <div id="vipContent" style="display:none;">
                    <div class="signal-box" style="border: 1px solid var(--accent-color); background: rgba(0,212,255,0.05);">
                        <h4 style="margin:0 0 10px 0; color:var(--accent-color);">√âL≈ê JELZ√âS</h4>
                        <p style="font-size:1.2rem; font-weight:bold;">BTC/USDT <span style="color:#0f0;">üü¢ LONG</span></p>
                        <p>Entry: $Market | TP: Open | SL: 2%</p>
                        <small style="color:#888;">Friss√≠tve: Most</small>
                    </div>
                </div>

                <div id="freeContent">
                    <div class="signal-box">
                        <p>üîí <strong>Ez a tartalom csak VIP tagoknak el√©rhet≈ë.</strong></p>
                        <p class="blur-text">BTC/USDT SHORT ENTRY 64200</p>
                        <button onclick="window.open('https://t.me/SkyAI00bot1', '_blank')" style="background:var(--accent-color); border:none; padding:10px 20px; border-radius:5px; cursor:pointer; font-weight:bold; margin-top:10px;">Csatlakozz a Telegramhoz</button>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        // *** KONFIGUR√ÅCI√ì ***
        const TOKEN_ADDRESS = "0xcBbaDC40Cde0F12679a6b0b74fB732E02E60fa83"; 
        const VIP_LIMIT = 5000;
        
        const TOKEN_ABI = [
            "function balanceOf(address owner) view returns (uint256)",
            "function decimals() view returns (uint8)"
        ];

        window.onload = async function() {
            const savedAddress = localStorage.getItem('skyai_wallet');
            const savedChain = localStorage.getItem('skyai_chain');

            if (!savedAddress) {
                // Ha nincs c√≠m, visszair√°ny√≠tunk, DE adunk egy kis id≈ët a b√∂ng√©sz≈ënek
                console.log("Nincs bejelentkezve, ir√°ny vissza...");
                window.location.href = "index.html";
                return;
            }

            document.getElementById('userAddress').innerText = savedAddress.substring(0,6) + "..." + savedAddress.substring(savedAddress.length-4);
            document.getElementById('nativeSymbol').innerText = savedChain || "BSC";

            if (savedChain === 'BNB' || !savedChain) { // Default to BNB ha nincs chain adat
                await loadBNBData(savedAddress);
            } else {
                document.getElementById('skyBalance').innerText = "BSC Only";
                document.getElementById('membershipLevel').innerText = "Free Member";
            }
        };

        async function loadBNBData(userAddress) {
            const provider = new ethers.providers.JsonRpcProvider("https://bsc-dataseed.binance.org/");
            
            try {
                // 1. BNB Egyenleg
                const balanceBNB = await provider.getBalance(userAddress);
                document.getElementById('nativeBalance').innerText = parseFloat(ethers.utils.formatEther(balanceBNB)).toFixed(4);

                // 2. SKY Token
                const contract = new ethers.Contract(TOKEN_ADDRESS, TOKEN_ABI, provider);
                const rawTokenBalance = await contract.balanceOf(userAddress);
                const tokenBalance = parseFloat(ethers.utils.formatEther(rawTokenBalance));

                document.getElementById('skyBalance').innerText = tokenBalance.toLocaleString('hu-HU', {maximumFractionDigits: 2});

                // 3. VIP Check
                if (tokenBalance >= VIP_LIMIT) {
                    activateVIP();
                } else {
                    document.getElementById('membershipLevel').innerText = "Free Member";
                    document.getElementById('membershipLevel').style.color = "#888";
                }
            } catch (error) {
                console.error("Hiba:", error);
                document.getElementById('skyBalance').innerText = "Hiba (H√°l√≥zat?)";
            }
        }

        function activateVIP() {
            const levelText = document.getElementById('membershipLevel');
            levelText.innerHTML = "‚≠êÔ∏è VIP TAG";
            levelText.style.color = "var(--vip-gold)";
            levelText.style.textShadow = "0 0 10px rgba(255,215,0,0.5)";
            
            document.getElementById('statusCard').classList.add('vip-card');
            document.getElementById('vipProgress').innerText = "Jogosult vagy az AI Jelz√©sekre!";
            
            document.getElementById('freeContent').style.display = 'none';
            document.getElementById('vipContent').style.display = 'block';
        }

        function logout() {
            localStorage.removeItem('skyai_wallet');
            localStorage.removeItem('skyai_chain');
            window.location.href = "index.html";
        }

        function showSection(section) {
            console.log("Navig√°l√°s:", section);
        }
    </script>
</body>
</html>
